---
import Layout from "@/layouts/Layout.astro";
import { Button } from "@/components/ui/button";
import { getCollection } from "astro:content";
import { ArrowRight, Globe } from "lucide-react";
import copy from "@/data/copy.json";
import Footer from "@/components/Footer.astro";
import "@/styles/globals.css";

const allpanduan = await getCollection("panduan");
const sortedpanduan = allpanduan.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const featuredGuide = sortedpanduan.find(guide => guide.data.featured) || sortedpanduan[0];
const otherpanduan = sortedpanduan.filter(guide => guide.slug !== featuredGuide.slug);

const categories = copy.panduan.categories;
---

<Layout
  title="Panduan & Tips Kerja Remote - Belajar Skill Digital"
  description="Kumpulan panduan lengkap cara kerja remote, belajar skill digital, tips produktivitas, dan manajemen karir global untuk pemula hingga profesional."
>
  <main class="flex min-h-screen flex-col pt-24">
    <div class="container mx-auto px-6 md:px-8 max-w-6xl pb-16">
      <div class="mb-12">
        <h1 class="text-4xl font-bold mb-4">{copy.panduan.title}</h1>
        <p class="text-muted-foreground text-lg max-w-2xl">
          {copy.panduan.subtitle}
        </p>
      </div>

      {/* Category Chips */}
      <div class="flex flex-wrap gap-2 mb-12">
        {categories.map((category, index) => (
          <Button 
            variant={index === 0 ? "default" : "outline"} 
            size="sm" 
            className="rounded-full"
          >
            {category}
          </Button>
        ))}
      </div>

      {/* Featured Guide */}
      {featuredGuide && (
        <div class="mb-16">
          <a href={`/panduan/${featuredGuide.slug}`} class="group block">
            <div class="grid md:grid-cols-2 gap-8 items-center bg-white rounded-lg border overflow-hidden hover:shadow-md transition-all duration-300">
              <div class="aspect-video md:aspect-[4/3] w-full overflow-hidden">
                <img 
                  src={featuredGuide.data.image} 
                  alt={featuredGuide.data.title} 
                  class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                />
              </div>
              <div class="p-6 md:p-8 flex flex-col justify-center">
                <div class="flex items-center gap-2 mb-4">
                  <span class="bg-primary/10 text-primary px-3 py-1 rounded-full text-xs font-medium">
                    {featuredGuide.data.category}
                  </span>
                  <span class="text-muted-foreground text-xs">
                    {featuredGuide.data.pubDate.toLocaleDateString('id-ID', { year: 'numeric', month: 'long', day: 'numeric' })}
                  </span>
                </div>
                <h2 class="text-3xl md:text-4xl font-bold mb-4 group-hover:text-primary transition-colors">
                  {featuredGuide.data.title}
                </h2>
                <p class="text-muted-foreground text-lg mb-6 line-clamp-3">
                  {featuredGuide.data.description}
                </p>
                <div class="flex items-center text-primary font-medium">
                  {copy.panduan.readMore} <ArrowRight className="w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform" />
                </div>
              </div>
            </div>
          </a>
        </div>
      )}

      {/* Grid of Cards */}
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        {otherpanduan.map((guide) => (
          <a href={`/panduan/${guide.slug}`} class="group flex flex-col h-full">
            <div class="bg-white rounded-lg border overflow-hidden hover:shadow-md transition-all duration-300 flex flex-col h-full">
              <div class="aspect-video overflow-hidden">
                <img 
                  src={guide.data.image} 
                  alt={guide.data.title} 
                  class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                />
              </div>
              <div class="p-6 flex flex-col flex-1">
                <div class="flex items-center justify-between mb-3">
                  <span class="text-xs font-medium text-primary">
                    {guide.data.category}
                  </span>
                  <span class="text-xs text-muted-foreground">
                    {guide.data.pubDate.toLocaleDateString('id-ID', { month: 'short', day: 'numeric', year: 'numeric' })}
                  </span>
                </div>
                <h3 class="text-xl font-bold mb-3 line-clamp-2 group-hover:text-primary transition-colors">
                  {guide.data.title}
                </h3>
                <p class="text-muted-foreground text-sm line-clamp-3 mb-4 flex-1">
                  {guide.data.description}
                </p>
              </div>
            </div>
          </a>
        ))}
      </div>
    </div>

    <Footer />
  </main>
</Layout>

